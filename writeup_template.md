# **Finding Lane Lines on the Road** 

---

**Finding Lane Lines on the Road**

The goals / steps of this project are the following:
* Make a pipeline that finds lane lines on the road
* Reflect on your work in a written report


[//]: # "Image References"

[image1]: (./test_images_output_LaneFindingPipeline/solidWhiteCurve_01_gray.jpg) "Grayscale"
---

### Reflection

### 1. Describe your pipeline. As part of the description, explain how you modified the draw_lines() function.

My pipeline consisted of 7 steps. Starting with the following image:

![solidWhiteCurve](/Users/brizo/Documents/workspace/car-nd/CarND-LaneLines-P1/test_images/solidWhiteCurve.jpg){:height="360px" width="36opx"}



1. I normalized the colors of the image so that I can reduce the effects of shadows and highlights.  You can see this in the image.![solidWhiteCurve_00_norm](/Users/brizo/Documents/workspace/car-nd/CarND-LaneLines-P1/test_images_output/LaneFindingPipeline/solidWhiteCurve_00_norm.jpg)

2. I then convert the image to grayscale

   ![solidWhiteCurve_01_gray](/Users/brizo/Documents/workspace/car-nd/CarND-LaneLines-P1/test_images_output/LaneFindingPipeline/solidWhiteCurve_01_gray.jpg)

3. Do a gaussian blur on the grayscale image to remove artifacts and false edges

4. Run a canny edge detection algorithm using an auto thresholding algorithm based on median threshold.  This algorith calculates the median value of the image then, given a sigma value, calculates the low threshold that is sigma below the median and a high threshold that is sigma above the median.

   ![solidWhiteCurve_02_canny](/Users/brizo/Documents/workspace/car-nd/CarND-LaneLines-P1/test_images_output/LaneFindingPipeline/solidWhiteCurve_02_canny.jpg)

5. A polygon fill is created to mask out the unwanted parts of the image.  I calculated the vertices based on ratios of the screen.  I am assuming that the camera is fixed where the horizon crosses through the middle of the frame and when the car is inside a set of lanes the left and right lanes are equally centered.  

   ![solidWhiteCurve_03_region](/Users/brizo/Documents/workspace/car-nd/CarND-LaneLines-P1/test_images_output/LaneFindingPipeline/solidWhiteCurve_03_region.jpg)

6. I then run the `HoughLinesP` algorithm that takes the points from the Canny Edge Detector and computes lane lines.

   ![solidWhiteCurve_04_lines](/Users/brizo/Documents/workspace/car-nd/CarND-LaneLines-P1/test_images_output/LaneFindingFullLine/solidWhiteCurve_04_lines.jpg)

7. The line is then overlayed onto the original image to show accuracy.

   ![solidWhiteCurve_05_weighted](/Users/brizo/Documents/workspace/car-nd/CarND-LaneLines-P1/test_images_output/LaneFindingFullLine/solidWhiteCurve_05_weighted.jpg)



In order to draw a single line on the left and right lanes, I modified the draw_lines() function by classifying  each line generated by the Hough Transform as either LEFT, RIGHT, or OTHER. This classification is done by looking at the slope of the line and position on screen.  If the slope is positive and between a lower and upper bound, then the line is on the right side.  If it is negative within similar lower and upper bounds, it belongs to the left lane.  Otherwise we consider it noise.  The reason for the flipped signs is because the image origin starts from the top left.  Once the left and right lines are classified, I use `np.polyfit` on the points for the left lane to get the best fit line and repeat for the right lane.  I then draw a line from the bottom of the screen to the top of the region of interest. 

Originally, I had used low threshold/line lenght/line gap values and had inconsitent results with detecting lines further away and would result in jumpy lines in the last video. Adjusting these values to `threshold = 30`, `min_line_length = 10` and `max_line_gap = 15` gave me much better results. 




### 2. Identify potential shortcomings with your current pipeline


One potential shortcoming would be what would happen when the road and lane lines are similar colors, like the portion of the challenge video where we passed over the bridge.  In the Challenge video, I was unable to detect the left lane when going over this bridge and caused the pipeline to crash.  

Another shortcoming could be crossing an intersection in the road or handling curves in the road because hte current pipeline only draws straight lines.  Our car would stop at the intersection or miss the curve.

A shortcoming in the line drawing function is that we draw to a fixed location, so if the road changes or the horizon changes on us, the lines we draw will extend too far.


### 3. Suggest possible improvements to your pipeline

A possible improvement would be to compare results from HSV/HSL and other color spaces to detect lanes that are closer to color and look for the best result. 

Another potential improvement could be to keep a history of the lanes to both dampen any effects of misclassified lines and to extrapolate new lines when there are no lines to be detected in the current frame.  

To handle curved roads, we could do a polynomial fit instead of a linear line fit between points, and this would allow us to find the curve in the road.

To improve the lane drawing function, I could detect the horizon and use that to dermine how far to draw the lane. 